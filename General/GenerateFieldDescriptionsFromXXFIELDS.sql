SELECT 'EXECUTE sp_addextendedproperty N''MS_Description'', N''' + REPLACE(NEW_DESCRIPTION, '''', '''''') + ''', N''USER'', N''dbo'', N''TABLE'', N''' + TABLE_NAME + ''', N''COLUMN'',N''' + COLUMN_NAME + '''' FROM
(SELECT TABLE_NAME, COLUMN_NAME, VALUE AS DESCRIPTION, CASE WHEN TABLE_NAME LIKE 'CM%' THEN (SELECT DEFAULTNAME FROM CMFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE CASE WHEN TABLE_NAME LIKE 'EF%' THEN (SELECT DEFAULTNAME FROM EFFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE CASE WHEN TABLE_NAME LIKE 'EL%' THEN (SELECT DEFAULTNAME FROM ELFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE CASE WHEN TABLE_NAME LIKE 'PK%' THEN (SELECT DEFAULTNAME FROM PKFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE CASE WHEN TABLE_NAME LIKE 'SW%' THEN (SELECT DEFAULTNAME FROM SWFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE CASE WHEN TABLE_NAME LIKE 'SM%' THEN (SELECT DEFAULTNAME FROM SMFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE CASE WHEN TABLE_NAME LIKE 'ST%' THEN (SELECT DEFAULTNAME FROM STFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE CASE WHEN TABLE_NAME LIKE 'WT%' THEN (SELECT DEFAULTNAME FROM WTFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE CASE WHEN TABLE_NAME LIKE 'WK%' THEN (SELECT DEFAULTNAME FROM WKFIELDS F WHERE F.TABLENAME = V1.TABLE_NAME AND F.FIELDNAME = COLUMN_NAME) ELSE NULL END END END END END END END END END AS NEW_DESCRIPTION FROM INFORMATION_SCHEMA.COLUMNS V1 LEFT JOIN SYS.EXTENDED_PROPERTIES PROPS ON OBJECT_ID(V1.TABLE_NAME) = PROPS.MAJOR_ID AND PROPS.MINOR_ID = COLUMNPROPERTY( OBJECT_ID(V1.TABLE_NAME),V1.COLUMN_NAME,'ColumnID') AND PROPS.CLASS_DESC = 'OBJECT_OR_COLUMN' WHERE (VALUE IS NULL OR VALUE = '')
AND TABLE_NAME IN (select TABLE_NAME from INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE')) S1 WHERE NEW_DESCRIPTION IS NOT NULL AND NEW_DESCRIPTION <> ''